[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project]
name = "valohai-cli"
dynamic = ["version"]
description = "Command line client for Valohai"
readme = "README.md"
license = "MIT"
requires-python = ">=3.8"
authors = [
    { name = "Valohai", email = "hait@valohai.com" },
]
dependencies = [
    "click>=7.0",
    "gitignorant>=0.2.0",
    "requests-toolbelt>=0.7.1",
    "requests>=2.0.0",
    "valohai-utils>=0.3.0",
    "valohai-yaml>=0.31.0",
]

[project.scripts]
vh = "valohai_cli.cli:cli"

[project.urls]
Homepage = "https://github.com/valohai/valohai-cli"

[tool.hatch.version]
path = "valohai_cli/__init__.py"

[tool.hatch.build.targets.sdist]
include = [
    "/valohai_cli",
]

[tool.mypy]
exclude = ".*test.*"

[[tool.mypy.overrides]]
module = "valohai.*"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "requests_toolbelt.*"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "requests_mock.*"
ignore_missing_imports = true

[tool.pytest.ini_options]
norecursedirs = [".git", ".tox"]
markers = ["slow: marks tests as slow (deselect with '-m \"not slow\"')"]

[tool.ruff]
target-version = "py38"
ignore = [
    "E501",
    "B904",
    "B905",
    "ANN101", # Missing type annotation for `self` in method
    "ANN102", # Missing type annotation for `cls` in classmethod
    "ANN401", # Dynamically typed expressions (typing.Any) are disallowed
    "RET504", # Unnecessary variable assignment before `return` statement
    "SIM105", # Use `contextlib.suppress(TypeError)` instead of try-except-pass
]
select = [
    "ARG",
    "ANN", # annotations
    "B", # bugbear
    "C", # complexity & comprehensions
    "E", # pycodestyle
    "F", # pyflakes
    "I", # isort
    "SIM", # simplify
    "UP", # pyupgrade
    "W", # pycodestyle
]
[tool.ruff.per-file-ignores]
"tests/*" = ["ARG", "ANN"]
